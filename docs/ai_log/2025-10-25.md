# AI Log — 2025-10-25

## Tasking — Workspace service abstraction
- Port overlay, viewport, similarity cache, and export logic into a reusable service layer so UI and helpers share the same implementation.

## Actions & Decisions
- Introduced `WorkspaceService` and `WorkspaceContext` to centralise overlay addition, viewport state, similarity cache access, and export pipelines. 【F:app/services/workspace.py†L1-L197】
- Wired Streamlit entry points to resolve the shared service, delegating overlay removal and export flows through the abstraction. 【F:app/ui/main.py†L189-L220】【F:app/ui/main.py†L1379-L1421】

## Verification
- `pytest tests/utils/test_specviz_compat.py` (skipped: specutils dependency unavailable in CI image). 【e04667†L1-L6】

## Docs Consulted
- Reviewed the SpecViz parity backlog to confirm helper expectations and attribution requirements. 【F:docs/research/specviz_improvement_backlog.md†L1-L20】

## Tasking — SpecViz helper parity & documentation
- Extend the SpecViz compatibility helper to expose viewer automation endpoints and publish user-facing documentation crediting jdaviz.

## Actions & Decisions
- Expanded the helper module to support `get_spectra`, `set_limits`, `run_plugin`, and `export_view`, re-exporting the API under `spectra.helpers` and updating compatibility shims. 【F:spectra/helpers/specviz_compat.py†L1-L209】【F:app/helpers/specviz_compat.py†L1-L18】
- Authored a helper reference guide that mirrors SpecViz’s documented signatures with explicit jdaviz credit. 【F:docs/app/specviz_helper_api.md†L1-L86】
- Added regression coverage asserting helper viewport control and export payload handling, skipping when specutils is absent. 【F:tests/utils/test_specviz_compat.py†L1-L103】

## Verification
- Documentation-only follow-up; see shared test command above.

## Docs Consulted
- SpecViz parity backlog (attribution + helper expectations). 【F:docs/research/specviz_improvement_backlog.md†L1-L20】
