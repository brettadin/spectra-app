# AI Log — 2025-10-05

## Tasking — v1.2.1g
- Move the reference trace selector and clear action out of the sidebar examples group into the Differential workspace.
- Ensure session state and regression coverage adapt to the relocated controls.
- Refresh continuity artefacts (version, brains, patch notes, AI log) per the v1.2+ blueprint.
- Capture an adoption blueprint translating JDaviz/Specviz capabilities into Spectra App planning artefacts.
- Update continuity artefacts (brains, patch notes, version, AI log) in line with the v1.2+ workflow contract.
- 
## Actions & Decisions
- Re-read the v1.2+ handoff blueprint to confirm continuity expectations before touching the layout. 【F:docs/ai_handoff/Spectra App v1.2+ – Handoff Protocol & Task Blueprint.txt†L1-L35】
- Added `_render_reference_controls` for reuse inside the Differential tab, wiring the selectbox and clear overlays button alongside comparison inputs while keeping state defaults intact. 【F:app/ui/main.py†L2098-L2142】
- Removed the reference widgets from `_render_examples_group` so the sidebar only surfaces example and library controls. 【F:app/ui/main.py†L883-L909】
- Extended the differential AppTest to assert the relocated reference selector and action button render as expected. 【F:tests/ui/test_differential_form.py†L44-L73】
- Logged the move across the new brains entry, patch notes, and version metadata for v1.2.1g 【F:docs/brains/brains_v1.2.1gmd†L1-L18】【F:docs/patch_notes/v1.2.1gd†L1-L20】【F:app/version.json†L1-L5】
- Reviewed the ASD help reference terminology to confirm user-facing language stays consistent. 【F:docs/mirrored/nist_asd_help/help.meta.json†L1-L6】
- Reviewed Jdaviz quickstart, Specviz import/display/plugin/export guides, Cubeviz/Specviz2D docs, and developer API references to catalogue ingestion pathways, viewer ergonomics, plugin coverage, export flows, and provenance expectations. 【F:docs/research/specviz_adaptation.md†L5-L68】
- Captured the findings in a gap matrix, phased roadmap, and research backlog to anchor Spectra App planning around SpecViz parity. 【F:docs/research/specviz_adaptation.md†L70-L144】
- Logged the blueprint in `docs/atlas/brains.md`, published patch notes `v1.2.1g`, bumped `app/version.json`, and extended `PATCHLOG.txt` for traceability. 【F:docs/atlas/brains.md†L205-L210】【F:docs/patch_notes/v1.2.1g.md†L1-L20】【F:app/version.json†L1-L5】【F:PATCHLOG.txt†L34-L38】
- Cross-referenced JWST archive guidance noting Jdaviz availability within the MAST portal to align our roadmap with community expectations. 【F:docs/mirrored/jwst_docs/accessing-jwst-data/mast-web-access.md†L60-L86】【F:docs/mirrored/jwst_docs/accessing-jwst-data/mast-web-access.meta.json†L1-L6】
- Compile a SpecViz/Jdaviz capability survey and translate it into an adoption blueprint for Spectra App.
- Update v1.2+ continuity collateral (brains, patch notes, patch log, version) to document the research handoff.

## Verification
- `pytest tests/ui/test_differential_form.py`

## Outstanding Follow-ups
- Explore inline guidance for how reference traces influence similarity scoring to aid new users.
- Restore the FAISS-backed docs index service highlighted in prior continuity logs.
- Prototype a helper API skeleton mirroring Specviz method names to validate feasibility before deeper UI work.
- Evaluate embedding strategies for Glue viewers inside Streamlit, including performance profiling of redshift slider patterns.
- Size the engineering effort for adopting `specutils` data models within our ingest pipeline.
- Prototype a pluggable panel/tray framework informed by the roadmap.
- Evaluate Glue integration depth and session persistence strategies noted in the research backlog.

## Docs Consulted
- Spectra App v1.2+ – Handoff Protocol & Task Blueprint. 【F:docs/ai_handoff/Spectra App v1.2+ – Handoff Protocol & Task Blueprint.txt†L1-L35】
- NIST Atomic Spectra Database help. 【F:docs/mirrored/nist_asd_help/help.meta.json†L1-L6】

## Tasking — v1.2.1h
- Compile a SpecViz/Jdaviz capability survey and translate it into an adoption blueprint for Spectra App.
- Update v1.2+ continuity collateral (brains, patch notes, patch log, version) to document the research handoff.

## Actions & Decisions
- Reviewed Jdaviz quickstart, Specviz import/display/plugin/export guides, Cubeviz/Specviz2D docs, and developer API references to catalogue ingestion pathways, viewer ergonomics, plugin coverage, export flows, and provenance expectations. 【F:docs/research/specviz_adaptation.md†L5-L68】
- Captured the findings in a gap matrix, phased roadmap, and research backlog to anchor Spectra App planning around SpecViz parity. 【F:docs/research/specviz_adaptation.md†L70-L144】
- Logged the blueprint in `docs/atlas/brains.md`, published patch notes `v1.2.1g`, bumped `app/version.json`, and extended `PATCHLOG.txt` for traceability. 【F:docs/atlas/brains.md†L205-L210】【F:docs/patch_notes/v1.2.1g.md†L1-L20】【F:app/version.json†L1-L5】【F:PATCHLOG.txt†L34-L38】
- Cross-referenced JWST archive guidance noting Jdaviz availability within the MAST portal to align our roadmap with community expectations. 【F:docs/mirrored/jwst_docs/accessing-jwst-data/mast-web-access.md†L60-L86】【F:docs/mirrored/jwst_docs/accessing-jwst-data/mast-web-access.meta.json†L1-L6】

## Verification
- Not applicable (documentation-only research update).

## Outstanding Follow-ups
- Size the engineering effort for adopting `specutils` data models within our ingest pipeline.
- Prototype a pluggable panel/tray framework informed by the roadmap.
- Evaluate Glue integration depth and session persistence strategies noted in the research backlog.

## Docs Consulted
- Jdaviz quickstart, Specviz, Cubeviz, Specviz2D, Mosviz, export, and API documentation. 【F:docs/research/specviz_adaptation.md†L5-L144】
- JWST MAST portal guidance referencing Jdaviz tooling. 【F:docs/mirrored/jwst_docs/accessing-jwst-data/mast-web-access.md†L60-L86】【F:docs/mirrored/jwst_docs/accessing-jwst-data/mast-web-access.meta.json†L1-L6】

## Tasking — v1.2.1h
- Review newly published Jdaviz GitHub developer docs and reconcile them against Spectra App’s current architecture.
- Produce a code-grounded alignment plan clarifying where to introduce registries, reusable components, helper APIs, and specutils-backed plugins.
- Refresh continuity collateral (brains, patch notes, patch log, version) to capture the follow-up research milestone.

## Actions & Decisions
- Downloaded the Jdaviz developer infrastructure, plugin component, UI, and selection references from GitHub to extend the external research baseline. 【F:docs/research/specviz_code_alignment.md†L1-L42】
- Audited Spectra App’s overlay model, ingest queue, analysis helpers, export manifest, and target gating to document the current implementation footprint. 【F:docs/research/specviz_code_alignment.md†L44-L89】
- Captured alignment gaps and next steps bridging Specviz patterns with Spectra App’s Streamlit architecture, informing future engineering spikes. 【F:docs/research/specviz_code_alignment.md†L91-L128】
- Logged the audit in brains, patch notes `v1.2.1h`, version metadata, and patch log to satisfy the v1.2+ continuity contract. 【F:docs/atlas/brains.md†L86-L94】【F:docs/patch_notes/v1.2.1h.md†L1-L11】【F:app/version.json†L1-L5】【F:PATCHLOG.txt†L34-L35】

## Verification
- Not applicable (documentation-only update).

## Outstanding Follow-ups
- Prototype the `panel_registry` abstraction and notebook helper API outlined in the alignment plan.
- Investigate capturing Plotly ROI selections as `specutils.SpectralRegion` exports for provenance parity.
- Evaluate specutils-backed fitting/smoothing plugins to replace bespoke NumPy pipelines.

## Docs Consulted
- Jdaviz developer documentation on infrastructure, plugin components, UI framework, and selections. 【F:docs/research/specviz_code_alignment.md†L1-L42】

- JDaviz Specviz user guide (external): https://jdaviz.readthedocs.io/en/latest/specviz/index.html
- JDaviz README (external): https://github.com/spacetelescope/jdaviz/blob/main/README.rst
- Jdaviz quickstart, Specviz, Cubeviz, Specviz2D, Mosviz, export, and API documentation. 【F:docs/research/specviz_adaptation.md†L5-L144】
- JWST MAST portal guidance referencing Jdaviz tooling. 【F:docs/mirrored/jwst_docs/accessing-jwst-data/mast-web-access.md†L60-L86】【F:docs/mirrored/jwst_docs/accessing-jwst-data/mast-web-access.meta.json†L1-L6】
