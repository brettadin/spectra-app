# AI Log — 2025-10-21

## Tasking — Streamlit import bootstrap
- Ensure Streamlit Cloud can execute `app/ui/main.py` directly without `ModuleNotFoundError` by bootstrapping package imports and updating release collateral.

## Actions & Decisions
- Prepend the repository root to `sys.path` when `__package__` is unset and switch UI imports to relative form so the module works when imported or executed as a file. 【F:app/ui/main.py†L25-L80】
- Rolled version metadata, patch notes, and brains documentation to capture the deployment-facing fix. 【F:app/version.json†L1-L5】【F:docs/patch_notes/v1.2.1f.md†L1-L20】【F:docs/atlas/brains.md†L1-L5】

## Verification
- `pytest tests/ui/test_docs_tab.py -q` 【7f26ef†L1-L2】

## Docs Consulted
- None.

## Tasking — Overlay ingest rerun stability
- Ensure overlay ingest futures created before a Streamlit rerun still resolve successfully and update release collateral.

## Actions & Decisions
- Moved `OverlayIngestResult` into `app.ingest` so worker futures keep returning the same class across reruns while `_refresh_ingest_jobs` continues to process payloads. 【F:app/ingest/results.py†L1-L18】【F:app/ui/main.py†L671-L798】
- Added a regression test that reloads `app.ui.main` before fulfilling a future and confirms `_add_overlay_payload` executes without the "Unexpected ingest result" fallback. 【F:tests/ui/test_overlay_ingest_queue_async.py†L186-L289】
- Updated version metadata and brains notes to document the hotfix. 【F:app/version.json†L1-L5】【F:docs/atlas/brains.md†L1-L24】

## Verification
- `pytest tests/ui/test_overlay_ingest_queue_async.py -q` 【795bdd†L1-L1】【7ae437†L1-L2】

## Docs Consulted
- None.
