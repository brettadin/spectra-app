# v1.2.1k — Controller extraction for overlay workspace

## Highlights
- Factored overlay, viewport, and differential helpers into a new `WorkspaceController` module so Streamlit code delegates to pure-Python operations. 【F:app/ui/controller.py†L1-L602】
- Refactored the Streamlit overlay tab to use the controller API and added a CLI demo that renders spectra without Streamlit. 【F:app/ui/main.py†L1621-L1900】【F:app/controller_demo.py†L1-L74】
- Added focused controller unit tests covering figure and similarity preparation logic. 【F:tests/ui/test_controller_module.py†L1-L66】

## Verification
- `pytest tests/ui/test_controller_module.py` 【90219d†L1-L6】
- `python -m app.controller_demo` 【1cc0cf†L1-L10】
# v1.2.1k — SpecViz-compatible ingestion helpers

- Added batch ingestion entry points that expand directories, capture per-file provenance, and expose success/failure summaries so scripted workflows mirror SpecViz directory imports. 【F:app/utils/local_ingest.py†L55-L167】【F:app/utils/local_ingest.py†L866-L1077】
- Published `SpecvizCompatHelper` to mirror jdaviz helper signatures, returning overlay payloads, batch reports, or diagnostics for scripted ingest. 【F:app/helpers/specviz_compat.py†L1-L156】【F:tests/utils/test_specviz_compat.py†L1-L64】
- Extended MAST, ESO, SDSS, and DOI providers to accept richer query payloads (program concatenation, cached catalog hints) while surfacing aggregated failure diagnostics. 【F:app/providers/mast.py†L61-L405】【F:app/providers/eso.py†L72-L233】【F:app/providers/sdss.py†L71-L252】【F:app/providers/doi.py†L64-L218】
- Logged the SpecViz improvement backlog reference to keep parity efforts aligned with jdaviz helper behaviors. 【F:docs/research/specviz_improvement_backlog.md†L1-L74】
# Patch Notes — v1.2.1k

## Summary
- Published the SpecViz parity matrix to connect Spectra App features to upstream documentation and deltas. 【F:docs/research/specviz_improvement_backlog.md†L5-L20】
- Linked user-facing guides to the new matrix and credited the jdaviz authors for the underlying SpecViz material. 【F:docs/app/user_guide.md†L1-L10】【F:docs/app/archive_and_provenance.md†L1-L8】【F:docs/app/overlay_workspace.md†L1-L9】【F:docs/app/differential_workspace.md†L1-L9】

## Details
1. **SpecViz parity matrix**
   - Added a feature-to-doc mapping table in the SpecViz improvement backlog that highlights ingestion, viewer, and plugin differences and credits the jdaviz authors. 【F:docs/research/specviz_improvement_backlog.md†L7-L16】
2. **User guide attribution**
   - Referenced the parity matrix from the user guide and workspace docs while calling out the jdaviz authors whose work informs Spectra App's roadmap. 【F:docs/app/user_guide.md†L1-L10】【F:docs/app/archive_and_provenance.md†L1-L8】【F:docs/app/overlay_workspace.md†L1-L9】【F:docs/app/differential_workspace.md†L1-L9】

## Verification
- Documentation-only change; no automated tests were run.
